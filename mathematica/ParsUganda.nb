(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18238,        446]
NotebookOptionsPosition[     17546,        426]
NotebookOutlinePosition[     17969,        443]
CellTagsIndexPosition[     17926,        440]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.968214453202074*^9, 3.968214454535582*^9}, {
  3.968214523380513*^9, 3.968214524316374*^9}, {3.9682145572970343`*^9, 
  3.968214558464937*^9}},ExpressionUUID->"4ac04439-480b-4630-977f-\
0bdf1f91b8bb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "SetDirectory", "[", "\"\<~/Dropbox/SpatialModelRepo/Runs\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"vector", " ", "of", " ", "dispersal", " ", "rates", " ", 
    RowBox[{"(", 
     RowBox[{
     "probability", " ", "of", " ", "moving", " ", "per", " ", "day", " ", 
      "per", " ", "adult"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dli", "=", 
   RowBox[{"0.02", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"5", "^", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.5"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dli", "=", 
   RowBox[{"{", "0.02", "}"}]}], ";", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "giving", " ", "lifetime", " ", "probability", " ", "of",
      " ", "dispersing"}], ",", " ", 
    RowBox[{
    "if", " ", "mortality", " ", "is", " ", "mu", " ", "and", " ", 
     "dispersal", " ", "rate", " ", "is", " ", "p"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pdisp", "[", 
     RowBox[{"mu_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"p", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "mu"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"mu", "+", "p", "-", 
        RowBox[{"mu", " ", "p"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "corresponding", " ", "vector", " ", "of", " ", "lifetime", " ", 
     "probability", " ", "to", " ", "move"}], ",", " ", 
    RowBox[{"if", " ", "daily", " ", "mortality", " ", "is", " ", "0.125"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pdisp", "[", 
        RowBox[{"0.125", ",", "#"}], "]"}], "&"}], ",", "dli"}], "]"}], "]"}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"vector", " ", "of", " ", "fitness", " ", "cots"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xili", "=", 
    RowBox[{"{", 
     RowBox[{"0.6", ",", "0.8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "vector", " ", "of", " ", "values", " ", "for", " ", "carrying", " ", 
    "capacity", " ", "parameter"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allis", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1000", ",", "9000", ",", "2000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allis", "=", 
    RowBox[{"{", "5000", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.959840692204272*^9, {3.959840738903487*^9, 3.959840780615754*^9}, {
   3.959840988378869*^9, 3.959841015705875*^9}, {3.95984106495367*^9, 
   3.9598410980726337`*^9}, {3.959841153058312*^9, 3.959841380815105*^9}, {
   3.959844194674281*^9, 3.959844197329348*^9}, {3.9598442715777817`*^9, 
   3.959844351646955*^9}, {3.959844386930305*^9, 3.959844390040174*^9}, {
   3.9598447676496067`*^9, 3.959844781202976*^9}, 3.959844869810224*^9, {
   3.959845883768819*^9, 3.959845885304456*^9}, {3.959846435046228*^9, 
   3.959846436622284*^9}, 3.959846486800039*^9, {3.959846555374049*^9, 
   3.959846584477269*^9}, {3.959846636876702*^9, 3.9598466548293333`*^9}, {
   3.959846740147935*^9, 3.95984679142788*^9}, {3.9598468431979113`*^9, 
   3.959846843980731*^9}, {3.959847212162195*^9, 3.9598472197278137`*^9}, {
   3.9598479750953193`*^9, 3.959847975574691*^9}, {3.95984820839349*^9, 
   3.9598482112622147`*^9}, {3.9598482669749537`*^9, 3.959848274635698*^9}, 
   3.959848412491924*^9, {3.959853650740076*^9, 3.959853668834167*^9}, 
   3.959853736335528*^9, {3.959853924791668*^9, 3.959853929074772*^9}, {
   3.959857472789339*^9, 3.959857476126924*^9}, {3.960611866048993*^9, 
   3.9606120691263657`*^9}, 3.9606122113197803`*^9, {3.960612282868927*^9, 
   3.96061247989559*^9}, {3.960612527061236*^9, 3.960612576514517*^9}, {
   3.960612722744277*^9, 3.960612723081444*^9}, {3.9606135975992403`*^9, 
   3.960613601963702*^9}, {3.96061366145461*^9, 3.960613720687169*^9}, {
   3.960613804143737*^9, 3.960613814495798*^9}, 3.960613974948962*^9, {
   3.960614020732993*^9, 3.9606140488666*^9}, 3.961132725831917*^9, 
   3.961133577300772*^9, {3.961660523239047*^9, 3.961660592009446*^9}, {
   3.961663470196229*^9, 3.961663489392383*^9}, {3.96166352924892*^9, 
   3.961663536611319*^9}, {3.961663570893775*^9, 3.9616635728475*^9}, {
   3.961670900966613*^9, 3.961670902788722*^9}, 3.961671070182451*^9, {
   3.961671809176262*^9, 3.961671882493313*^9}, {3.9616719167945423`*^9, 
   3.961672025423794*^9}, {3.961672059318989*^9, 3.961672093220758*^9}, {
   3.9616722096367283`*^9, 3.961672234283431*^9}, {3.9616725354369907`*^9, 
   3.96167253826117*^9}, {3.961672685713041*^9, 3.961672691195667*^9}, {
   3.961757564471019*^9, 3.961757576924808*^9}, {3.968314719447627*^9, 
   3.968314742392591*^9}, {3.972462761993046*^9, 3.9724627941816387`*^9}, {
   3.972462825819682*^9, 3.972462844314988*^9}, {3.972463018464273*^9, 
   3.972463224860229*^9}, {3.9724633910034847`*^9, 3.972463402035405*^9}, {
   3.972463473749625*^9, 3.972463491480489*^9}, {3.9744441847754173`*^9, 
   3.9744442082570257`*^9}},ExpressionUUID->"ceb1b6e4-6192-4dbe-83aa-\
0b4a4a729941"],

Cell[BoxData[
 RowBox[{"{", "0.12280701754385966`", "}"}]], "Print",
 CellChangeTimes->{3.972463402752705*^9, 3.972463492790018*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"b3b268c5-a87e-4b5a-9b2d-b3993c70f20a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"input", "=", 
      RowBox[{
       RowBox[{"{", "\"\<../InputData/Rel2Vil.txt\>\"", "}"}], "[", 
       RowBox[{"[", "size", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pa", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"numruns", "=", "1"}], ",", 
         RowBox[{"maxT", "=", 
          RowBox[{
           RowBox[{"28", " ", "365"}], "+", "150"}]}], ",", 
         RowBox[{"NumPat", "=", 
          RowBox[{
           RowBox[{"{", "726", "}"}], "[", 
           RowBox[{"[", "size", "]"}], "]"}]}], ",", 
         RowBox[{"muJ", "=", "0.05"}], ",", 
         RowBox[{"muA", "=", "0.125"}], ",", 
         RowBox[{"beta", "=", "100"}], ",", 
         RowBox[{"theta", "=", "9"}], ",", 
         RowBox[{"meanTL", "=", "0.0667"}], ",", 
         RowBox[{"mindev", "=", "10"}], ",", 
         RowBox[{"gamma", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "0.95"}], ")"}], "/", "2"}]}], ",", 
         RowBox[{"xiA", "=", 
          RowBox[{"xili", "[", 
           RowBox[{"[", "xx", "]"}], "]"}]}], ",", 
         RowBox[{"eA", "=", "0.95"}], ",", 
         RowBox[{"drivertime", "=", 
          RowBox[{
           RowBox[{"25", " ", "365"}], "+", "150"}]}], ",", 
         RowBox[{"NumDriver", "=", "500"}], ",", 
         RowBox[{"NumDriverPat", "=", "1"}], ",", 
         RowBox[{"d", "=", 
          RowBox[{"dli", "[", 
           RowBox[{"[", "dd", "]"}], "]"}]}], ",", 
         RowBox[{"L", "=", 
          RowBox[{"5", "/", "111."}]}], 
         RowBox[{"(*", 
          RowBox[{
          "5", "km", " ", "maximum", " ", "dispersal", " ", "distance"}], 
          "*)"}], ",", 
         RowBox[{"psi", "=", "0"}], ",", 
         RowBox[{"muAES", "=", "0.9"}], ",", 
         RowBox[{"thide1", "=", "300"}], ",", 
         RowBox[{"thide2", "=", "350"}], ",", 
         RowBox[{"twake1", "=", "140"}], ",", 
         RowBox[{"twake2", "=", "170"}], ",", 
         RowBox[{"allis", "[", 
          RowBox[{"[", "a0", "]"}], "]"}], ",", 
         RowBox[{"al0var", "=", "0."}], ",", 
         RowBox[{"allis", "[", 
          RowBox[{"[", "a1", "]"}], "]"}], " ", ",", 
         RowBox[{"amp", "=", "0"}], ",", 
         RowBox[{"resp", "=", ".25"}], ",", 
         RowBox[{"recstart", "=", 
          RowBox[{
           RowBox[{"24", " ", "365"}], "+", "150"}]}], ",", 
         RowBox[{"recend", "=", "maxT"}], ",", 
         RowBox[{"recIntGlob", "=", "1"}], ",", 
         RowBox[{"recIntLoc", "=", "5"}], ",", 
         RowBox[{"recsitesfreq", "=", "1"}], ",", 
         RowBox[{"set", "=", 
          RowBox[{
           RowBox[{"100000", "a0"}], "+", 
           RowBox[{"10000", "a1"}], "+", 
           RowBox[{"1000", " ", "size"}], "+", 
           RowBox[{"100", " ", "rel"}], "+", 
           RowBox[{"10", " ", 
            RowBox[{"(", "xx", ")"}]}], "+", "dd"}]}], ",", "\"\<e\>\"", 
         ",", "\"\<r\>\"", ",", 
         RowBox[{"start", "=", 
          RowBox[{
           RowBox[{"24", " ", "365"}], "+", "1"}]}], ",", "input", 
         ",", "\"\<../InputData/IslandRain.csv\>\"", ",", 
         RowBox[{
          RowBox[{"{", 
           
           RowBox[{"\"\<../InputData/Rellist.csv\>\"", 
            ",", "\"\<../InputData/RellistSingle.csv\>\""}], "}"}], "[", 
          RowBox[{"[", "rel", "]"}], "]"}], 
         ",", "\"\<../InputData/ConsMort.csv\>\"", ",", 
         RowBox[{"outputtype", "=", "0"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"\"\<Pars\>\"", "<>", 
        RowBox[{"ToString", "[", "set", "]"}], "<>", "\"\<.csv\>\""}], ",", 
       "pa", ",", "\"\<CSV\>\"", ",", 
       RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"rel", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"size", ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xx", ",", 
      RowBox[{"Length", "[", "xili", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dd", ",", 
      RowBox[{"Length", "[", "dli", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a0", ",", 
      RowBox[{"Length", "[", "allis", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", 
      RowBox[{"Length", "[", "allis", "]"}]}], "}"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{
  3.959840692204272*^9, {3.959840738903487*^9, 3.959840780615754*^9}, {
   3.959840988378869*^9, 3.959841015705875*^9}, {3.95984106495367*^9, 
   3.9598410980726337`*^9}, {3.959841153058312*^9, 3.959841380815105*^9}, {
   3.959844194674281*^9, 3.959844197329348*^9}, {3.9598442715777817`*^9, 
   3.959844351646955*^9}, {3.959844386930305*^9, 3.959844390040174*^9}, {
   3.9598447676496067`*^9, 3.959844781202976*^9}, 3.959844869810224*^9, {
   3.959845883768819*^9, 3.959845885304456*^9}, {3.959846435046228*^9, 
   3.959846436622284*^9}, 3.959846486800039*^9, {3.959846555374049*^9, 
   3.959846584477269*^9}, {3.959846636876702*^9, 3.9598466548293333`*^9}, {
   3.959846740147935*^9, 3.95984679142788*^9}, {3.9598468431979113`*^9, 
   3.959846843980731*^9}, {3.959847212162195*^9, 3.9598472197278137`*^9}, {
   3.9598479750953193`*^9, 3.959847975574691*^9}, {3.95984820839349*^9, 
   3.9598482112622147`*^9}, {3.9598482669749537`*^9, 3.959848274635698*^9}, 
   3.959848412491924*^9, {3.959853650740076*^9, 3.959853668834167*^9}, 
   3.959853736335528*^9, {3.959853924791668*^9, 3.959853929074772*^9}, {
   3.959857472789339*^9, 3.959857476126924*^9}, {3.960611866048993*^9, 
   3.9606120691263657`*^9}, 3.9606122113197803`*^9, {3.960612282868927*^9, 
   3.96061247989559*^9}, {3.960612527061236*^9, 3.960612576514517*^9}, {
   3.960612722744277*^9, 3.960612723081444*^9}, {3.9606135975992403`*^9, 
   3.960613601963702*^9}, {3.96061366145461*^9, 3.960613720687169*^9}, {
   3.960613804143737*^9, 3.960613814495798*^9}, 3.960613974948962*^9, {
   3.960614020732993*^9, 3.9606140488666*^9}, 3.961132725831917*^9, 
   3.961133577300772*^9, {3.961660523239047*^9, 3.961660592009446*^9}, {
   3.961663470196229*^9, 3.961663489392383*^9}, {3.96166352924892*^9, 
   3.961663536611319*^9}, {3.961663570893775*^9, 3.9616635728475*^9}, {
   3.961670900966613*^9, 3.961670902788722*^9}, 3.961671070182451*^9, {
   3.961671809176262*^9, 3.961671882493313*^9}, {3.9616719167945423`*^9, 
   3.961672025423794*^9}, {3.961672059318989*^9, 3.961672093220758*^9}, {
   3.9616724068940573`*^9, 3.961672427468726*^9}, {3.961672546470344*^9, 
   3.961672559496737*^9}, {3.96167259092135*^9, 3.961672640221824*^9}, {
   3.961757655525446*^9, 3.9617576568022213`*^9}, {3.961757755587275*^9, 
   3.961757755623576*^9}, {3.96727421463447*^9, 3.967274216028594*^9}, 
   3.967276102057528*^9, {3.968215587349545*^9, 3.968215611376527*^9}, {
   3.968216145496578*^9, 3.968216146951178*^9}, {3.96821624774762*^9, 
   3.968216275274602*^9}, {3.968216495723868*^9, 3.968216500846731*^9}, {
   3.968219203981062*^9, 3.968219226139976*^9}, {3.9683139437839823`*^9, 
   3.968313949042714*^9}, {3.968314667111004*^9, 3.968314686566066*^9}, {
   3.968314770472431*^9, 3.968314801404853*^9}, {3.969092755741848*^9, 
   3.969092786962916*^9}, {3.9724634220850897`*^9, 3.9724634555205584`*^9}, {
   3.972463504125557*^9, 3.972463525625504*^9}, {3.972463589197857*^9, 
   3.972463629812602*^9}, 3.972473702501679*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"5d7c6825-a6ff-4114-bfb7-597160cb3b32"]
},
WindowSize->{1440, 833.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2b3afd63-5283-47c2-8546-a0fbe0ca5f4f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 249, 4, 32, "Input",ExpressionUUID->"4ac04439-480b-4630-977f-0bdf1f91b8bb"],
Cell[CellGroupData[{
Cell[832, 28, 8924, 229, 440, "Input",ExpressionUUID->"ceb1b6e4-6192-4dbe-83aa-0b4a4a729941"],
Cell[9759, 259, 237, 5, 25, "Print",ExpressionUUID->"b3b268c5-a87e-4b5a-9b2d-b3993c70f20a"]
}, Open  ]],
Cell[10011, 267, 7531, 157, 221, "Input",ExpressionUUID->"5d7c6825-a6ff-4114-bfb7-597160cb3b32"]
}
]
*)

